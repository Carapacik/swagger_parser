openapi: 3.1.0
info:
  title: ""
  version: 0.0.0 (v1)
# Define reusable schema components
components:
  schemas:
    # This anchor is defined here but will be used in included endpoint
    AuditInfo: &auditAnchor
      type: object
      properties:
        lastModified:
          type: string
          format: date-time
          description: Last modified timestamp from anchor
        modifiedBy:
          type: string
          description: User who modified from anchor
      required:
        - lastModified
    # Unreferenced anchor in components - should not generate model
    UnreferencedComponent: &unreferencedComponentAnchor
      type: object
      properties:
        neverUsedComponent:
          type: string
          description: This component is never referenced
        unusedNumber:
          type: integer
          minimum: 0
    # Anchor only used in excluded schemas - should not generate model
    ExcludedCrossSchemaAnchor: &excludedCrossAnchor
      type: object
      properties:
        crossSchemaField:
          type: string
          description: This anchor is only used in excluded schemas
        crossSchemaBoolean:
          type: boolean
          default: true
    # First excluded schema with cross-reference
    ExcludedComponentA:
      type: object
      properties:
        componentAField:
          type: string
        # First cross-schema reference to excludedCrossAnchor
        sharedCrossData: *excludedCrossAnchor
        anotherFieldA:
          type: integer
    # Second excluded schema with cross-reference
    ExcludedComponentB:
      type: object
      properties:
        componentBField:
          type: array
          items:
            type: string
        # Second cross-schema reference to excludedCrossAnchor
        embeddedCrossData: *excludedCrossAnchor
        anotherFieldB:
          type: number
          format: float
paths:
  /api/v1/tagged-as-exclude-but-included-should-be-included/:
    get:
      operationId: api_v1_category_list
      tags:
        - client
        - include
        - exclude
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                includedField:
                  type: string
                  description: This field should be included (include tag wins)
                includedNested:
                  type: object
                  properties:
                    includedInner:
                      type: string
                # Reference the anchor defined in excluded-only schema
                auditData: *auditAnchor
              required:
                - includedField
      responses:
        "200":
          description: Success response
          content:
            application/json:
              schema:
                type: object
                properties:
                  includedResponse:
                    type: string
                  includedData:
                    type: object
                    properties:
                      dataField:
                        type: string
                      level:
                        type: string
                        enum:
                          - LOW
                          - MEDIUM
                          - HIGH
                          - CRITICAL
                      priority:
                        type: integer
                required:
                  - includedResponse
  /api/v1/tagged-as-exclude-but-not-included-should-be-excluded/:
    get:
      operationId: api_v1_category_list_excluded
      tags:
        - client
        - exclude
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                excludedField:
                  type: string
                  description: This field should NOT be included
                excludedNested:
                  type: object
                  properties:
                    shouldNotAppear:
                      type: string
                # Unreferenced anchor in excluded path - should not generate model
                unusedExcludedAnchor: &excludedUnusedAnchor
                  type: object
                  properties:
                    unusedExcludedField:
                      type: string
                      description: This is in an excluded path and never referenced
                    anotherUnusedField:
                      type: array
                      items:
                        type: string
                # Anchor only used in excluded contexts - should not generate model
                onlyExcludedAnchor: &onlyInExcludedContexts
                  type: object
                  properties:
                    excludedOnlyField:
                      type: string
                      description: Anchor used only in excluded tags
                    excludedOnlyNumber:
                      type: number
                      format: double
                # First reference to onlyInExcludedContexts (excluded context)
                excludedContextRef1: *onlyInExcludedContexts
                # Second reference to onlyInExcludedContexts (excluded context)
                excludedContextRef2: *onlyInExcludedContexts
      responses:
        "200":
          description: Success response
          content:
            application/json:
              schema:
                type: object
                properties:
                  excludedResponse:
                    type: string
                  excludedData:
                    type: object
                    properties:
                      notIncluded:
                        type: string
                  # Third reference to onlyInExcludedContexts (in excluded response)
                  excludedResponseAnchorRef: *onlyInExcludedContexts
                  # Reference to ExcludedComponentA (in excluded response)
                  excludedComponentARef:
                    $ref: '#/components/schemas/ExcludedComponentA'
                  # Reference to ExcludedComponentB (in excluded response)
                  excludedComponentBRef:
                    $ref: '#/components/schemas/ExcludedComponentB'
  /api/v1/no-tags-endpoint:
    get:
      operationId: api_v1_no_tags
      # No tags - should be filtered out when includeTags is set
      responses:
        "200":
          description: No tags response
          content:
            application/json:
              schema:
                type: object
                properties:
                  noTagsData:
                    type: string
  /api/v1/empty-tags-endpoint:
    get:
      operationId: api_v1_empty_tags  
      tags: []  # Empty tags - should be filtered out when includeTags is set
      responses:
        "200":
          description: Empty tags response
          content:
            application/json:
              schema:
                type: object
                properties:
                  emptyTagsData:
                    type: string
